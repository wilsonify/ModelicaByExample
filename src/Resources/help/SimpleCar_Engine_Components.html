<HTML>
<HEAD><META name="HTML-Generator" content="Dymola"><TITLE>SimpleCar</TITLE></HEAD>
<BODY><P>
<H2><A NAME="SimpleCar.Engine.Components"></A><A HREF="SimpleCar_Engine.html#SimpleCar.Engine"
>SimpleCar.Engine</A>.Components</H2>
<B>A collection of components used to build engines</B>
<P>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.PropertyModel"
><IMG SRC="SimpleCar.Engine.Components.PropertyModelI.gif" ALT="SimpleCar.Engine.Components.PropertyModel" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.ChamberVolume"
><IMG SRC="SimpleCar.Engine.Components.ChamberVolumeI.gif" ALT="SimpleCar.Engine.Components.ChamberVolume" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.ControlVolume"
><IMG SRC="SimpleCar.Engine.Components.ControlVolumeI.gif" ALT="SimpleCar.Engine.Components.ControlVolume" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Orifice"
><IMG SRC="SimpleCar.Engine.Components.OrificeI.gif" ALT="SimpleCar.Engine.Components.Orifice" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Throttle"
><IMG SRC="SimpleCar.Engine.Components.ThrottleI.gif" ALT="SimpleCar.Engine.Components.Throttle" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Valve"
><IMG SRC="SimpleCar.Engine.Components.ValveI.gif" ALT="SimpleCar.Engine.Components.Valve" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.MasslessPiston"
><IMG SRC="SimpleCar.Engine.Components.MasslessPistonI.gif" ALT="SimpleCar.Engine.Components.MasslessPiston" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.OffsetShaft"
><IMG SRC="SimpleCar.Engine.Components.OffsetShaftI.gif" ALT="SimpleCar.Engine.Components.OffsetShaft" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.CrankSlider"
><IMG SRC="SimpleCar.Engine.Components.CrankSliderI.gif" ALT="SimpleCar.Engine.Components.CrankSlider" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.SparkControl"
><IMG SRC="SimpleCar.Engine.Components.SparkControlI.gif" ALT="SimpleCar.Engine.Components.SparkControl" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.TimingBelt"
><IMG SRC="SimpleCar.Engine.Components.TimingBeltI.gif" ALT="SimpleCar.Engine.Components.TimingBelt" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Combustion"
><IMG SRC="SimpleCar.Engine.Components.CombustionI.gif" ALT="SimpleCar.Engine.Components.Combustion" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Dynamometer"
><IMG SRC="SimpleCar.Engine.Components.DynamometerI.gif" ALT="SimpleCar.Engine.Components.Dynamometer" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.IndividualCylinder"
><IMG SRC="SimpleCar.Engine.Components.IndividualCylinderI.gif" ALT="SimpleCar.Engine.Components.IndividualCylinder" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Cam"
><IMG SRC="SimpleCar.Engine.Components.CamI.gif" ALT="SimpleCar.Engine.Components.Cam" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Reservoir"
><IMG SRC="SimpleCar.Engine.Components.ReservoirI.gif" ALT="SimpleCar.Engine.Components.Reservoir" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine"
><IMG SRC="SimpleCar.Engine.Components.I4_EngineI.gif" ALT="SimpleCar.Engine.Components.I4_Engine" WIDTH=80  HEIGHT=80 ></A>
<A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Manifold"
><IMG SRC="SimpleCar.Engine.Components.ManifoldI.gif" ALT="SimpleCar.Engine.Components.Manifold" WIDTH=80  HEIGHT=80 ></A>
<P><P>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ReservoirI.gif" ALT="SimpleCar.Engine.Components.Reservoir" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Reservoir"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Reservoir</H2>
<B>Infinite reservoir</B><p>
<IMG SRC="SimpleCar.Engine.Components.ReservoirD.gif" ALT="SimpleCar.Engine.Components.Reservoir">
<H3>Information</H3>
<PRE>This infinite reservoir model is capable of supplying any amount of mass or energy (via the mdot and q flow variables on the
Gas connector) to sustain a specified temperature and pressure.

These &quot;infinite&quot; models are interesting because instead of including constitutive relationships between
flow values (mass flow and power) and the potentials of the system (pressure and temperature), they instead
provide algebraic constraints involving only the states.  It is assumed that the flows will be calculated
such that the constraints will be satisfied.  This kind of model is analagous to an ideal voltage source (supplies
as much current as is necessary to sustain a specified voltage) or a mechanical ground (supplies as much
force as is necessary to sustain a specified position).
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>P</TD><TD>101800</TD><TD>Reservoir pressure [Pa]</TD></TR>
<TR><TD>T</TD><TD>300</TD><TD>Reservoir temperature [K]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Reservoir &quot;Infinite reservoir&quot;
  parameter Modelica.SIunits.Pressure P=101800 &quot;Reservoir pressure&quot;;
  parameter Modelica.SIunits.Temperature T=300
    &quot;Reservoir temperature&quot;;
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> tap;
equation
  tap.P = P;
  tap.T = T;
end Reservoir;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.IndividualCylinderI.gif" ALT="SimpleCar.Engine.Components.IndividualCylinder" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.IndividualCylinder"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.IndividualCylinder</H2>
<B>Collection of parts for a complete individual cylinder</B><p>
<IMG SRC="SimpleCar.Engine.Components.IndividualCylinderD.gif" ALT="SimpleCar.Engine.Components.IndividualCylinder">
<H3>Information</H3>
<PRE>All the basic componets of a single cylinder, 2-valve engine
have been compiled in this model.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>spark_advance</TD><TD></TD><TD>Spark advance [deg]</TD></TR>
<TR><TD>burn_duration</TD><TD></TD><TD>Burn Duration [deg]</TD></TR>
<TR><TD>evo</TD><TD>40</TD><TD>Exhaust Valve Opening [deg]</TD></TR>
<TR><TD>ivo</TD><TD>150</TD><TD>Intake Valve Opening [deg]</TD></TR>
<TR><TD>evc</TD><TD>205</TD><TD>Exhaust Valve Closing [deg]</TD></TR>
<TR><TD>ivc</TD><TD>310</TD><TD>Intake Valve Closing [deg]</TD></TR>
<TR><TD>crank_shift</TD><TD>0</TD><TD>Crankshaft Shift [deg]</TD></TR>
<TR><TD>ivd</TD><TD>0.032</TD><TD>Intake Valve Diameter [m]</TD></TR>
<TR><TD>evd</TD><TD>0.028</TD><TD>Exhaust Valve Diameter [m]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model IndividualCylinder
  &quot;Collection of parts for a complete individual cylinder&quot;
  extends <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Cylinder"
>Interfaces.Cylinder</A>;
  parameter Types.Degrees spark_advance &quot;Spark advance&quot;;
  parameter Types.Degrees burn_duration &quot;Burn Duration&quot;;
  parameter Types.Degrees evo=40 &quot;Exhaust Valve Opening&quot;;
  parameter Types.Degrees ivo=150 &quot;Intake Valve Opening&quot;;
  parameter Types.Degrees evc=205 &quot;Exhaust Valve Closing&quot;;
  parameter Types.Degrees ivc=310 &quot;Intake Valve Closing&quot;;
  parameter Types.Degrees crank_shift=0 &quot;Crankshaft Shift&quot;;
  parameter Modelica.SIunits.Diameter ivd=0.032
    &quot;Intake Valve Diameter&quot;;
  parameter Modelica.SIunits.Diameter evd=0.028
    &quot;Exhaust Valve Diameter&quot;;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.MasslessPiston"
>Engine.Components.MasslessPiston</A> piston;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.CrankSlider"
>Engine.Components.CrankSlider</A> crankslider;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.ControlVolume"
>Engine.Components.ControlVolume</A> combustion_chamber;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Valve"
>Engine.Components.Valve</A> intake_valve(dia=ivd);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Valve"
>Engine.Components.Valve</A> exhaust_valve(dia=evd);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.TimingBelt"
>Engine.Components.TimingBelt</A> timing_belt;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Cam"
>Engine.Components.Cam</A> intake_cam(vo=ivo, vc=ivc);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Cam"
>Engine.Components.Cam</A> exhaust_cam(vo=evo, vc=evc);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Combustion"
>Engine.Components.Combustion</A> combustion_model(burn_duration=burn_duration
    );
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.SparkControl"
>Engine.Components.SparkControl</A> spark_control(spark_advance=spark_advance)
    ;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.ChamberVolume"
>Engine.Components.ChamberVolume</A> chamber_volume;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.OffsetShaft"
>OffsetShaft</A> offset_shaft(shift=crank_shift);
equation
  connect(crankslider.geom, geom);
  connect(chamber_volume.geom, geom);
  connect(intake_valve.a, intake);
  connect(exhaust_valve.a, exhaust);
  connect(piston.chamber, combustion_chamber.state);
  connect(intake_cam.valve_lift, intake_valve.lift);
  connect(exhaust_cam.valve_lift, exhaust_valve.lift);
  connect(intake_cam.camshaft, timing_belt.camshaft);
  connect(exhaust_cam.camshaft, timing_belt.camshaft);
  connect(intake_valve.b, combustion_chamber.state);
  connect(combustion_chamber.state, exhaust_valve.b);
  connect(combustion_model.cylinder, combustion_chamber.state);
  connect(combustion_model.crank, spark_control.crank);
  connect(spark_control.spark, combustion_model.start);
  connect(chamber_volume.volume, combustion_chamber.volume);
  connect(combustion_chamber.mass, combustion_model.mass);
  connect(piston.geom, geom);
  connect(piston.piston, crankslider.piston);
  connect(chamber_volume.piston, crankslider.piston);
  connect(offset_shaft.cyl, crankslider.crank);
  connect(offset_shaft.crank, crankshaft);
  connect(timing_belt.crankshaft, crankslider.crank);
  connect(spark_control.crank, crankslider.crank);
end IndividualCylinder;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.DynamometerI.gif" ALT="SimpleCar.Engine.Components.Dynamometer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Dynamometer"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Dynamometer</H2>
<B>Ideal Dynamometer</B><p>
<IMG SRC="SimpleCar.Engine.Components.DynamometerD.gif" ALT="SimpleCar.Engine.Components.Dynamometer">
<H3>Information</H3>
<PRE>This dynamometer model is ideal.  This means that the dynamometer appear (to anything connected to it) to have
an infinite mass.  It is important that the input signal is continuous.  Furthermore the input signal has units
of &quot;revolutions per minute&quot;.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>cycle_fraction</TD><TD>1.0</TD><TD>Average over what fraction of the cycle</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Dynamometer &quot;Ideal Dynamometer&quot;
  parameter Real cycle_fraction=1.0
    &quot;Average over what fraction of the cycle&quot;;
  Modelica.SIunits.Energy work;
  Modelica.SIunits.Energy last_work;
  Modelica.SIunits.Torque avg_tau;
  Modelica.SIunits.Angle next_rotation;
  Types.RPM avg_rpm;
  Modelica.SIunits.Time previous_time;
  <I></I>
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> rpm(final n=1);
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> shaft;
equation
  der(shaft.phi) = rpm.signal[1]*Modelica.Constants.pi/30;
  der(work) = shaft.tau*der(shaft.phi);
algorithm
  when initial() then
    next_rotation := shaft.phi + cycle_fraction*4*Modelica.Constants.pi;
    last_work := 0;
    previous_time := time;
    avg_rpm := rpm.signal[1];
  end when;
  when shaft.phi &gt; next_rotation then
    next_rotation := next_rotation + cycle_fraction*4*Modelica.Constants.pi;
    avg_tau := (work - pre(last_work))/(cycle_fraction*4*Modelica.Constants.pi
      );
    avg_rpm := 120*cycle_fraction/(time - pre(previous_time));
    last_work := work;
    previous_time := time;
  end when;
end Dynamometer;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.I4_EngineI.gif" ALT="SimpleCar.Engine.Components.I4_Engine" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.I4_Engine"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.I4_Engine</H2>
<B>An Inline 4 Cylinder Engine</B><p>
<IMG SRC="SimpleCar.Engine.Components.I4_EngineD.gif" ALT="SimpleCar.Engine.Components.I4_Engine">
<H3>Information</H3>
<PRE>An assembly of components required for an I4 engine.  This model requires a connection to intake and exhaust
gases, the crankshaft and geometry information.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>spark_advance</TD><TD></TD><TD>Spark advance [deg]</TD></TR>
<TR><TD>burn_duration</TD><TD></TD><TD>Burn Duration [deg]</TD></TR>
<TR><TD>evo</TD><TD>40</TD><TD>Exhaust Valve Opening [deg]</TD></TR>
<TR><TD>ivo</TD><TD>150</TD><TD>Intake Valve Opening [deg]</TD></TR>
<TR><TD>evc</TD><TD>205</TD><TD>Exhaust Valve Closing [deg]</TD></TR>
<TR><TD>ivc</TD><TD>310</TD><TD>Intake Valve Closing [deg]</TD></TR>
<TR><TD>ivd</TD><TD>0.032</TD><TD>Intake Valve Diameter [m]</TD></TR>
<TR><TD>evd</TD><TD>0.028</TD><TD>Exhaust Valve Diameter [m]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model I4_Engine &quot;An Inline 4 Cylinder Engine&quot;
  extends <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Engine"
>Interfaces.Engine</A>;
  parameter Types.Degrees spark_advance &quot;Spark advance&quot;;
  parameter Types.Degrees burn_duration &quot;Burn Duration&quot;;
  parameter Types.Degrees evo=40 &quot;Exhaust Valve Opening&quot;;
  parameter Types.Degrees ivo=150 &quot;Intake Valve Opening&quot;;
  parameter Types.Degrees evc=205 &quot;Exhaust Valve Closing&quot;;
  parameter Types.Degrees ivc=310 &quot;Intake Valve Closing&quot;;
  parameter Modelica.SIunits.Diameter ivd=0.032
    &quot;Intake Valve Diameter&quot;;
  parameter Modelica.SIunits.Diameter evd=0.028
    &quot;Exhaust Valve Diameter&quot;;
  Modelica.SIunits.Power power &quot;Instantaneous engine power output&quot;;
  replaceable model CylinderType = IndividualCylinder extends
    Interfaces.Cylinder;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine.CylinderType"
>CylinderType</A> cylinder1(
    crank_shift=0,
    spark_advance=spark_advance,
    burn_duration=burn_duration,
    evo=evo,
    ivo=ivo,
    evc=evc,
    ivc=ivc,
    ivd=ivd,
    evd=evd);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine.CylinderType"
>CylinderType</A> cylinder2(
    crank_shift=360,
    spark_advance=spark_advance,
    burn_duration=burn_duration,
    evo=evo,
    ivo=ivo,
    evc=evc,
    ivc=ivc,
    ivd=ivd,
    evd=evd);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine.CylinderType"
>CylinderType</A> cylinder3(
    crank_shift=540,
    spark_advance=spark_advance,
    burn_duration=burn_duration,
    evo=evo,
    ivo=ivo,
    evc=evc,
    ivc=ivc,
    ivd=ivd,
    evd=evd);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine.CylinderType"
>CylinderType</A> cylinder4(
    crank_shift=180,
    spark_advance=spark_advance,
    burn_duration=burn_duration,
    evo=evo,
    ivo=ivo,
    evc=evc,
    ivc=ivc,
    ivd=ivd,
    evd=evd);
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational.html#Modelica.Mechanics.Rotational.Inertia"
>Modelica.Mechanics.Rotational.Inertia</A> crankshaft_inertia(J=0.03, w(start=
          157));
equation
  connect(cylinder1.intake, intake);
  connect(cylinder3.intake, intake);
  connect(cylinder2.intake, intake);
  connect(cylinder4.intake, intake);
  connect(cylinder1.exhaust, exhaust);
  connect(cylinder4.exhaust, exhaust);
  connect(cylinder3.exhaust, exhaust);
  connect(cylinder2.exhaust, exhaust);
  connect(cylinder4.geom, engine_geometry);
  connect(cylinder2.geom, engine_geometry);
  connect(cylinder3.geom, engine_geometry);
  connect(cylinder1.geom, engine_geometry);
  connect(cylinder1.crankshaft, cylinder3.crankshaft);
  connect(cylinder2.crankshaft, cylinder3.crankshaft);
  connect(cylinder4.crankshaft, cylinder2.crankshaft);
  connect(crankshaft_inertia.flange_b, cylinder1.crankshaft);
  connect(crankshaft_inertia.flange_a, crankshaft);
  power = crankshaft.tau*der(crankshaft.phi);
end I4_Engine;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ManifoldI.gif" ALT="SimpleCar.Engine.Components.Manifold" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Manifold"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Manifold</H2>
<B>A simple filling-and-emptying manifold model</B><p>
<IMG SRC="SimpleCar.Engine.Components.ManifoldD.gif" ALT="SimpleCar.Engine.Components.Manifold">
<H3>Information</H3>
<PRE>This very simple model contains a throttle and a control volume which
can be connected to the intake system of an engine (or cylinder) in
order to simulate the effects of manifold filling and emptying.  A
throttle position of 90 degrees corresponds to wide open throttle (WOT)
while a throttle position of 0 degrees corresponds to a closed throttle.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>volume</TD><TD>0.004</TD><TD>Manifold volume [m3]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Manifold &quot;A simple filling-and-emptying manifold model&quot;
  parameter Modelica.SIunits.Volume volume=0.004 &quot;Manifold volume&quot;;
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.ControlVolume"
>Engine.Components.ControlVolume</A> manifold_volume;
  <A HREF="../../Modelica/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</A> volume_value(final k={volume});
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> ambient;
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> manifold;
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> throttle_angle(final n=1);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Throttle"
>Engine.Components.Throttle</A> throttle(dia=0.10);
equation
  connect(volume_value.outPort, manifold_volume.volume);
  connect(manifold_volume.state, manifold);
  connect(throttle.b, manifold_volume.state);
  connect(throttle.a, ambient);
  connect(throttle_angle, throttle.throttle_angle);
end Manifold;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ControlVolumeI.gif" ALT="SimpleCar.Engine.Components.ControlVolume" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.ControlVolume"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.ControlVolume</H2>
<B>Thermodynamic control volume</B><p>
<IMG SRC="SimpleCar.Engine.Components.ControlVolumeD.gif" ALT="SimpleCar.Engine.Components.ControlVolume">
<H3>Information</H3>
<PRE>This model contains the basic equations of a thermodynamic control volume.  These include the conservation of mass and energy
as well as the ideal gas law and gas property equations.  The volume of the control volume is an input to this model
and the current mass contained within the control volume is an output.  The output signal for mass is necessary to
connect a combustion model.
</PRE>
<H3>Modelica definition</H3>
<PRE>
model ControlVolume &quot;Thermodynamic control volume&quot;
protected
  Modelica.SIunits.Energy U(start=147) &quot;Total energy&quot;;
  Modelica.SIunits.Mass m(start=4e-4) &quot;Total mass&quot;;
  Modelica.SIunits.Pressure P(start=101800) = state.P &quot;Pressure&quot;;
  Modelica.SIunits.Temperature T(start=300) = state.T &quot;Temperature&quot;;
  Modelica.SIunits.MassFlowRate mdot=state.mdot &quot;Net mass flow&quot;;
  Modelica.SIunits.Power q=state.q &quot;Net power&quot;;
  Modelica.SIunits.Volume V=volume.signal[1] &quot;Chamber volume&quot;;
  Modelica.SIunits.AmountOfSubstance N &quot;Number of moles of gas&quot;;
  Real R=Modelica.Constants.R;
  Real logV;
  Real logP;
public
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> volume(final n=1);
public
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.OutPort"
>Modelica.Blocks.Interfaces.OutPort</A> mass;
public
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> state &quot;Gas state&quot;;
protected
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.PropertyModel"
>PropertyModel</A> props(T=T, P=P);
equation
  <I>// Compute number of moles</I>
  N = m/props.mw;
  <I></I>
  <I>// Ideal gas low</I>
  P*V = N*R*T;
  <I></I>
  <I>// First law of thermodynamics</I>
  der(U) = q - P*der(V);
  U = m*props.u;
  <I></I>
  <I>// Conservation of mass</I>
  der(m) = mdot;
  mass.signal[1] = m;
  logV = Modelica.Math.log(V);
  logP = Modelica.Math.log(P);
end ControlVolume;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ValveI.gif" ALT="SimpleCar.Engine.Components.Valve" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Valve"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Valve</H2>
<B>Engine poppet valve</B><p>
<IMG SRC="SimpleCar.Engine.Components.ValveD.gif" ALT="SimpleCar.Engine.Components.Valve">
<H3>Information</H3>
<PRE>This is a very simple model of an engine valve the is derived from the &quot;Orifice&quot; model of isentropic flow.
The valve model must be connected to two different gas volumes (or reservoirs).  In addition, a translational
connector is used to represent the lift of the valve.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>dia</TD><TD>0.012</TD><TD>Valve diameter [m]</TD></TR>
<TR><TD>max_lift</TD><TD>0.012</TD><TD>Maximum Valve Lift [m]</TD></TR>
<TR><TD>max_discharge</TD><TD>0.7</TD><TD>Maximum Discharge Coefficient</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Valve &quot;Engine poppet valve&quot;
  parameter Modelica.SIunits.Diameter dia=0.012 &quot;Valve diameter&quot;;
  parameter Modelica.SIunits.Length max_lift=0.012
    &quot;Maximum Valve Lift&quot;;
  parameter Real max_discharge=0.7 &quot;Maximum Discharge Coefficient&quot;;
  extends <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Orifice"
>Orifice</A>(final Aref=Modelica.Constants.PI*(dia/2)^2);
protected
  parameter Real c_over_l=max_discharge/max_lift;
public
  <A HREF="../../Modelica/help/Modelica_Mechanics_Translational_Interfaces.html#Modelica.Mechanics.Translational.Interfaces.Flange_a"
>Modelica.Mechanics.Translational.Interfaces.Flange_a</A> lift;
equation
  lift.f = 0;
  Cd = c_over_l*lift.s;
  <I>// Cd = 0.0;</I>
end Valve;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.CamI.gif" ALT="SimpleCar.Engine.Components.Cam" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Cam"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Cam</H2>
<B>Valvetrain cam</B><p>
<IMG SRC="SimpleCar.Engine.Components.CamD.gif" ALT="SimpleCar.Engine.Components.Cam">
<H3>Information</H3>
<PRE>This is an idealized cam model that computes a cam profile from the valve timing (opening and closing) and the
maximum lift.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>vo</TD><TD>40</TD><TD>Valve Open [deg]</TD></TR>
<TR><TD>vc</TD><TD>205</TD><TD>Valve Close [deg]</TD></TR>
<TR><TD>max_lift</TD><TD>0.012</TD><TD>Maximum valve lift [m]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Cam &quot;Valvetrain cam&quot;
  <I></I>
  parameter Types.Degrees vo=40 &quot;Valve Open&quot;;
  parameter Types.Degrees vc=205 &quot;Valve Close&quot;;
  parameter Modelica.SIunits.Length max_lift=0.012
    &quot;Maximum valve lift&quot;;
  Types.Degrees local_ca &quot;Local camshaft angle&quot;;
protected
  parameter Real norm=1.0/(vc - vo);
public
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> camshaft;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Translational_Interfaces.html#Modelica.Mechanics.Translational.Interfaces.Flange_a"
>Modelica.Mechanics.Translational.Interfaces.Flange_a</A> valve_lift;
equation
  assert(vc &gt; vo + 20, &quot;Invalid cam timings&quot;);
  camshaft.tau = 0;
  valve_lift.s = if (local_ca &lt; vo or local_ca &gt; vc) then 0.0 else
    max_lift*Modelica.Math.sin((local_ca - vo)*norm*Modelica.Constants.PI)^2;
  local_ca = mod(camshaft.phi*180.0/Modelica.Constants.PI, 360);
  <I></I>
end Cam;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.PropertyModelI.gif" ALT="SimpleCar.Engine.Components.PropertyModel" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.PropertyModel"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.PropertyModel</H2>
<IMG SRC="SimpleCar.Engine.Components.PropertyModelD.gif" ALT="SimpleCar.Engine.Components.PropertyModel">
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<I><TR><TD>cp</TD><TD>1039</TD><TD>Specific heat capacity at constant pressure [J/(kg.K)]</TD></TR>
</I><I><TR><TD>mole_weight</TD><TD>0.028964</TD><TD>Molecular weight [kg/mol]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
replaceable model PropertyModel = GasProperties.SimpleAirProperties;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ChamberVolumeI.gif" ALT="SimpleCar.Engine.Components.ChamberVolume" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.ChamberVolume"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.ChamberVolume</H2>
<B>Computes combustion chamber volume as a function of piston position</B><p>
<IMG SRC="SimpleCar.Engine.Components.ChamberVolumeD.gif" ALT="SimpleCar.Engine.Components.ChamberVolume">
<H3>Information</H3>
<PRE>This model is used to compute the combustion chamber volume as a function
of piston position.  The has connectors for providing engine geometry
characteristics and the piston position and computes the chamber volume
as an output signal.

Note that this model does not really interact with the piston because it
does not result in any force being applied to the piston.  It is important
when creating models that are &quot;read-only&quot; for a given domain (e.g. the
translational domain in the case of the piston position) that a zero
contribution be provided for any flow variables.
</PRE>
<H3>Modelica definition</H3>
<PRE>
model ChamberVolume
  &quot;Computes combustion chamber volume as a function of piston position&quot;

  <A HREF="../../Modelica/help/Modelica_Mechanics_Translational_Interfaces.html#Modelica.Mechanics.Translational.Interfaces.Flange_a"
>Modelica.Mechanics.Translational.Interfaces.Flange_a</A> piston;
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.OutPort"
>Modelica.Blocks.Interfaces.OutPort</A> volume(final n=1);
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.EngineGeometryRequired"
>Interfaces.EngineGeometryRequired</A> geom;
equation
  volume.signal[1] = geom.Vc + geom.Ap*piston.s;
  piston.f = 0;
end ChamberVolume;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.OrificeI.gif" ALT="SimpleCar.Engine.Components.Orifice" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Orifice"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Orifice</H2>
<B>Isentropic flow restriction</B><p>
<IMG SRC="SimpleCar.Engine.Components.OrificeD.gif" ALT="SimpleCar.Engine.Components.Orifice">
<H3>Information</H3>
<PRE>This is a base model for other models which model isentropic flow (e.g. throttles, engine valves)
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Aref</TD><TD></TD><TD>Reference Area [m2]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Orifice &quot;Isentropic flow restriction&quot;
  parameter Modelica.SIunits.Area Aref &quot;Reference Area&quot;;
protected
  Modelica.SIunits.MassFlowRate mdot &quot;Flow from 'a' to 'b'&quot;;
  Modelica.SIunits.SpecificEnthalpy h &quot;Upstream enthalpy&quot;;
  Modelica.SIunits.SpecificEnthalpy gamma &quot;Upstream gamma&quot;;
  Real pratio &quot;Pressure ratio&quot;;
  Real Cd &quot;Discharge Coefficient&quot;;
public
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> a;
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> b;
protected
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.PropertyModel"
>PropertyModel</A> a_props(T=a.T, P=a.P);
  <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.PropertyModel"
>PropertyModel</A> b_props(T=b.T, P=b.P);
equation
  a.mdot = mdot;
  b.mdot = -mdot;
  a.q = mdot*h;
  b.q = -mdot*h;
  if noEvent(a.P &gt; b.P) then
    h = a_props.h;
    gamma = a_props.gamma;
    pratio = b.P/a.P;
    if (pratio &lt;= (2.0/(gamma + 1.0))^(gamma/(gamma - 1.0))) then
      mdot = Cd*Aref*a.P/((Modelica.Constants.R/a_props.mw)*a.T)^0.5*gamma^0.5
        *(2.0/(gamma + 1.0))^((gamma + 1.0)/(2.0*(gamma - 1.0)));
    else
      mdot = Cd*Aref*a.P/((Modelica.Constants.R/a_props.mw)*a.T)^0.5*pratio^(
        1.0/gamma)*(2.0*gamma/(gamma - 1.0)*(1.0 - pratio^((gamma - 1.0)/gamma)
        ))^0.5;
    end if;
  else
    h = b_props.h;
    gamma = b_props.gamma;
    pratio = a.P/b.P;
    if (pratio &lt;= (2.0/(gamma + 1.0))^(gamma/(gamma - 1.0))) then
      mdot = -Cd*Aref*b.P/((Modelica.Constants.R/b_props.mw)*b.T)^0.5*gamma^
        0.5*(2.0/(gamma + 1.0))^((gamma + 1.0)/(2.0*(gamma - 1.0)));
    else
      mdot = -Cd*Aref*b.P/((Modelica.Constants.R/b_props.mw)*b.T)^0.5*pratio^(
        1.0/gamma)*(2.0*gamma/(gamma - 1.0)*(1.0 - pratio^((gamma - 1.0)/gamma)
        ))^0.5;
    end if;
  end if;
end Orifice;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.ThrottleI.gif" ALT="SimpleCar.Engine.Components.Throttle" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Throttle"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Throttle</H2>
<B>Orifice with throttle plate</B><p>
<IMG SRC="SimpleCar.Engine.Components.ThrottleD.gif" ALT="SimpleCar.Engine.Components.Throttle">
<H3>Information</H3>
<PRE>A very simple engine throttle.  The input signal is the throttle angle.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>dia</TD><TD>0.1</TD><TD>Throttle diameter [m]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Throttle &quot;Orifice with throttle plate&quot;
  parameter Modelica.SIunits.Diameter dia=0.1 &quot;Throttle diameter&quot;;
  extends <A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.Orifice"
>Orifice</A>(final Aref=Modelica.Constants.PI*(dia/2)^2);
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> throttle_angle(final n=1)
    &quot;Throttle Angle [deg]&quot;;
equation
  Cd = Modelica.Math.sin(throttle_angle.signal[1]*Modelica.Constants.PI/180)^2
    ;
end Throttle;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.MasslessPistonI.gif" ALT="SimpleCar.Engine.Components.MasslessPiston" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.MasslessPiston"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.MasslessPiston</H2>
<B>A massless piston</B><p>
<IMG SRC="SimpleCar.Engine.Components.MasslessPistonD.gif" ALT="SimpleCar.Engine.Components.MasslessPiston">
<H3>Information</H3>
<PRE>This piston is used to translate pressure inside the cylinder into force (presumably applied to the crank slider mechanism).
This piston has no mass.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Pcc</TD><TD>101800</TD><TD>Crankcase pressure [Pa]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model MasslessPiston &quot;A massless piston&quot;
  parameter Modelica.SIunits.Pressure Pcc=101800
    &quot;Crankcase pressure&quot;;
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.EngineGeometryRequired"
>Interfaces.EngineGeometryRequired</A> geom;
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> chamber;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Translational_Interfaces.html#Modelica.Mechanics.Translational.Interfaces.Flange_a"
>Modelica.Mechanics.Translational.Interfaces.Flange_a</A> piston;
equation
  piston.f = geom.Ap*(chamber.P - Pcc);
  chamber.mdot = 0;
  chamber.q = 0;
  <I></I>
end MasslessPiston;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.OffsetShaftI.gif" ALT="SimpleCar.Engine.Components.OffsetShaft" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.OffsetShaft"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.OffsetShaft</H2>
<B>Angular displacement</B><p>
<IMG SRC="SimpleCar.Engine.Components.OffsetShaftD.gif" ALT="SimpleCar.Engine.Components.OffsetShaft">
<H3>Information</H3>
<PRE>Each cylinder is shifted on that crank shaft.  This model enforces an angular displacement from one flange to another
so that each cylinder can be rigidly connected to the crankshaft by independently shifted.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>shift</TD><TD>0</TD><TD>Shift from crankshaft [deg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model OffsetShaft &quot;Angular displacement&quot;
  parameter Types.Degrees shift=0 &quot;Shift from crankshaft&quot;;
  Types.RPM shaft_speed;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> crank;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> cyl;
equation
  shaft_speed = 30*der(crank.phi)/Modelica.Constants.pi;
  crank.tau + cyl.tau = 0;
  cyl.phi = crank.phi + shift*Modelica.Constants.PI/180.0;
end OffsetShaft;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.CrankSliderI.gif" ALT="SimpleCar.Engine.Components.CrankSlider" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.CrankSlider"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.CrankSlider</H2>
<B>A crank slider mechanism</B><p>
<IMG SRC="SimpleCar.Engine.Components.CrankSliderD.gif" ALT="SimpleCar.Engine.Components.CrankSlider">
<H3>Information</H3>
<PRE>This model represents the crank slider mechanism used to turn translational
force into the rotational torque applied to the crankshaft.
</PRE>
<H3>Modelica definition</H3>
<PRE>
model CrankSlider &quot;A crank slider mechanism&quot;
protected
  Modelica.SIunits.Length d;
  Modelica.SIunits.Angle phi;
  Real cp;
  Real sp;
public
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.EngineGeometryRequired"
>Interfaces.EngineGeometryRequired</A> geom;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> crank;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Translational_Interfaces.html#Modelica.Mechanics.Translational.Interfaces.Flange_a"
>Modelica.Mechanics.Translational.Interfaces.Flange_a</A> piston;
equation
  assert(geom.conrod &gt; geom.crank,
    &quot;Connecting rod length greater than crank length&quot;);
  cp = Modelica.Math.cos(phi);
  sp = Modelica.Math.sin(phi);
  phi = crank.phi;
  d = sqrt(geom.conrod^2 - (geom.crank*sp)^2);
  piston.s = (geom.crank + geom.conrod) - (geom.crank*cp + sqrt(geom.conrod^2
     - geom.crank^2*sp^2));
  crank.tau = piston.f*(sp*geom.crank + cp*sp*geom.crank^2/sqrt(d));
end CrankSlider;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.SparkControlI.gif" ALT="SimpleCar.Engine.Components.SparkControl" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.SparkControl"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.SparkControl</H2>
<B>Spark plug control</B><p>
<IMG SRC="SimpleCar.Engine.Components.SparkControlD.gif" ALT="SimpleCar.Engine.Components.SparkControl">
<H3>Information</H3>
<PRE>This model triggers the firing of the spark plug when the piston reaches a prescribed number of degrees
before top dead center of the compression/combustion strokes.  A real spark control strategy would allow
the spark strategy to change as engine conditions changed but this model just assumes a fixed
&quot;spark advance&quot;.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>spark_advance</TD><TD>20</TD><TD>Before top-dead-center (TDC) [deg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model SparkControl &quot;Spark plug control&quot;
  parameter Types.Degrees spark_advance=20
    &quot;Before top-dead-center (TDC)&quot;;
protected
  Types.Degrees cur_pos;
  Types.Degrees next_spark;
public
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BooleanOutPort"
>Modelica.Blocks.Interfaces.BooleanOutPort</A> spark;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> crank;
equation
  crank.tau = 0;
  cur_pos = crank.phi*180/Modelica.Constants.PI;
algorithm
  when initial() then
    next_spark := -spark_advance;
    while (next_spark &lt; cur_pos) loop
      next_spark := next_spark + 720;
    end while;
  end when;
  spark.signal[1] := cur_pos &gt; next_spark;
  when spark.signal[1] then
    next_spark := next_spark + 720;
  end when;
end SparkControl;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.TimingBeltI.gif" ALT="SimpleCar.Engine.Components.TimingBelt" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.TimingBelt"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.TimingBelt</H2>
<B>Engine timing belt</B><p>
<IMG SRC="SimpleCar.Engine.Components.TimingBeltD.gif" ALT="SimpleCar.Engine.Components.TimingBelt">
<H3>Information</H3>
<PRE>A timing belt that makes sure the camshaft spins at half the frequency as the crank shaft.
</PRE>
<H3>Modelica definition</H3>
<PRE>
model TimingBelt &quot;Engine timing belt&quot;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> crankshaft;
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> camshaft;
equation
  2*camshaft.phi = crankshaft.phi;
  camshaft.tau = 2*crankshaft.tau;
end TimingBelt;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.CombustionI.gif" ALT="SimpleCar.Engine.Components.Combustion" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.Combustion"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components"
>SimpleCar.Engine.Components</A>.Combustion</H2>
<B>Simple combustion model</B><p>
<IMG SRC="SimpleCar.Engine.Components.CombustionD.gif" ALT="SimpleCar.Engine.Components.Combustion">
<H3>Information</H3>
<PRE>This is a simplified combustion models.  This
model works by computing an instantaneous heat
release (i.e. energy given off as a result
of combustion) based on an idealized combustion
transient.  The duration of the burning is
typically determined by the motion of the
fuel/air mixture inside the cylinder but in
the case of this model it is assumed that
the burn duration is a fixed parameter.
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>lhv</TD><TD>44e+6</TD><TD>Lower heating value [J/kg]</TD></TR>
<TR><TD>afr</TD><TD>14.6</TD><TD>Stoichiometric Air/Fuel Ratio</TD></TR>
<TR><TD>burn_duration</TD><TD>60</TD><TD>Duration of combustion [deg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
model Combustion &quot;Simple combustion model&quot;
  parameter Modelica.SIunits.SpecificEnergy lhv=44e+6
    &quot;Lower heating value&quot;;
  parameter Real afr=14.6 &quot;Stoichiometric Air/Fuel Ratio&quot;;
  parameter Types.Degrees burn_duration=60 &quot;Duration of combustion&quot;;
protected
  Modelica.SIunits.Energy amplitude;
  Modelica.SIunits.AngularVelocity w;
  Real dps;
  Modelica.SIunits.Time start_burn(start=-1);
  Modelica.SIunits.Time end_burn(start=-1);
  Boolean burning(start=false);
  Real tmp;
public
  <A HREF="SimpleCar_Interfaces.html#SimpleCar.Interfaces.Gas"
>Interfaces.Gas</A> cylinder;
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.InPort"
>Modelica.Blocks.Interfaces.InPort</A> mass(final n=1);
  <A HREF="../../Modelica/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BooleanInPort"
>Modelica.Blocks.Interfaces.BooleanInPort</A> start(final n=1);
  <A HREF="../../Modelica/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> crank;
equation
  assert(burn_duration &gt; 1, &quot;Invalid burn duration&quot;);
  cylinder.mdot = 0;
  cylinder.q = if (burning) then -amplitude*Modelica.Math.sin((time -
    start_burn)/(end_burn - start_burn)*Modelica.Constants.PI)^2 else 0.0;
  der(tmp) = cylinder.q;
  w = der(crank.phi);
  dps = w*180/Modelica.Constants.PI;
  crank.tau = 0;
algorithm
  when start.signal[1] then
    start_burn := time;
    end_burn := time + (burn_duration/dps);
    amplitude := lhv*(mass.signal[1]/(afr + 1))*2.0*dps/burn_duration;
    burning := true;
  end when;
  when time &gt;= end_burn then
    burning := false;
  end when;
end Combustion;
</PRE>
<HR>
<H2><IMG SRC="SimpleCar.Engine.Components.I4_Engine.CylinderTypeI.gif" ALT="SimpleCar.Engine.Components.I4_Engine.CylinderType" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="SimpleCar.Engine.Components.I4_Engine.CylinderType"></A><A HREF="SimpleCar_Engine_Components.html#SimpleCar.Engine.Components.I4_Engine"
>SimpleCar.Engine.Components.I4_Engine</A>.CylinderType</H2>
<IMG SRC="SimpleCar.Engine.Components.I4_Engine.CylinderTypeD.gif" ALT="SimpleCar.Engine.Components.I4_Engine.CylinderType">
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<I><TR><TD>spark_advance</TD><TD></TD><TD>Spark advance [deg]</TD></TR>
</I><I><TR><TD>burn_duration</TD><TD></TD><TD>Burn Duration [deg]</TD></TR>
</I><I><TR><TD>evo</TD><TD>40</TD><TD>Exhaust Valve Opening [deg]</TD></TR>
</I><I><TR><TD>ivo</TD><TD>150</TD><TD>Intake Valve Opening [deg]</TD></TR>
</I><I><TR><TD>evc</TD><TD>205</TD><TD>Exhaust Valve Closing [deg]</TD></TR>
</I><I><TR><TD>ivc</TD><TD>310</TD><TD>Intake Valve Closing [deg]</TD></TR>
</I><I><TR><TD>crank_shift</TD><TD>0</TD><TD>Crankshaft Shift [deg]</TD></TR>
</I><I><TR><TD>ivd</TD><TD>0.032</TD><TD>Intake Valve Diameter [m]</TD></TR>
</I><I><TR><TD>evd</TD><TD>0.028</TD><TD>Exhaust Valve Diameter [m]</TD></TR>
</I></TABLE>
<H3>Modelica definition</H3>
<PRE>
replaceable model CylinderType = IndividualCylinder extends Interfaces.Cylinder;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Tue Feb 13 21:47:49 2001
.
</address></BODY>
</HTML>
