<HTML>
<HEAD><META name="HTML-Generator" content="Dymola"><TITLE>BookExamples</TITLE></HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Chapter5<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5"></A><A HREF="BookExamples.html#BookExamples"
>BookExamples</A>.Chapter5</H2>
<A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestComplexWave"
><IMG SRC="BookExamples.Chapter5.TestComplexWaveI.png" ALT="BookExamples.Chapter5.TestComplexWave" WIDTH=80  HEIGHT=80 ></A>
<A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestComplexWave2"
><IMG SRC="BookExamples.Chapter5.TestComplexWave2I.png" ALT="BookExamples.Chapter5.TestComplexWave2" WIDTH=80  HEIGHT=80 ></A>
<A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestFindName"
><IMG SRC="BookExamples.Chapter5.TestFindNameI.png" ALT="BookExamples.Chapter5.TestFindName" WIDTH=80  HEIGHT=80 ></A>
<A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestPiecewise"
><IMG SRC="BookExamples.Chapter5.TestPiecewiseI.png" ALT="BookExamples.Chapter5.TestPiecewise" WIDTH=80  HEIGHT=80 ></A>
<A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestPolyEval"
><IMG SRC="BookExamples.Chapter5.TestPolyEvalI.png" ALT="BookExamples.Chapter5.TestPolyEval" WIDTH=80  HEIGHT=80 ></A>
<P><P>
<H3>Information</H3>
<PRE>The models in this package are taken from
Chapter 5 of:

'Introduction to Physical Modeling with Modelica'

by Michael Tiller
</PRE><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.ComplexWave"
>ComplexWave</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.FindName"
>FindName</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.Piecewise"
>Piecewise</A>
</TD><TD>A piecewise linear interpolation</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.PolyEval"
>PolyEval</A>
</TD><TD>Evaluate polynomial and derivative</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestComplexWave"
>TestComplexWave</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestComplexWave2"
>TestComplexWave2</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestFindName"
>TestFindName</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestPiecewise"
>TestPiecewise</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.TestPolyEval"
>TestPolyEval</A>
</TD><TD>&nbsp;</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ComplexWave<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5.ComplexWave"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.ComplexWave</H2>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> ComplexWave
  <font color="blue">encapsulated </font><font color="blue">record</font> Data
    <font color="blue">import </font><A HREF="../../Modelica/help/Modelica.html#Modelica"
>Modelica</A>;
    <font color="blue">constant </font>Integer num <font color="darkgreen">&quot;Number of waves&quot;</font>;
    Real a[num] <font color="darkgreen">&quot;Wave amplitudes&quot;</font>;
    <A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits.Frequency"
>Modelica.SIunits.Frequency</A> f[num] <font color="darkgreen">&quot;Wave frequencies&quot;</font>;
    <A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> phase[num] <font color="darkgreen">&quot;Wave phase offset&quot;</font>;
  <font color="blue">end </font>Data;
  <font color="darkgreen"></font>
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;Independent variable&quot;</font>;
  <font color="blue">input </font><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.ComplexWave.Data"
>Data</A> d <font color="darkgreen">&quot;Wave data&quot;</font>;
  <font color="blue">output </font>Real y <font color="darkgreen">&quot;Sum of sine waves&quot;</font>;
<font color="blue">protected </font>
  Integer n;
  Real s;
<font color="blue">algorithm </font>
  n := d.num;
  y := 0;
  <font color="blue">for </font>i<font color="blue"> in </font>1:n<font color="blue"> loop</font>
    s := <font color="red">Modelica.Math.sin</font>(2*Modelica.Constants.pi*d.f[i]*x + d.phase[i]);
    y := y + d.a[i]*s;
  <font color="blue">end for</font>;
<font color="blue">end </font>ComplexWave;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FindName<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5.FindName"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.FindName</H2>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> FindName
  <font color="blue">input </font>String names[:];
  <font color="blue">input </font>String name_to_find;
  <font color="blue">output </font>Integer index;
<font color="blue">protected </font>
  Integer i;
  Integer len=<font color="red">size</font>(names, 1);
<font color="blue">algorithm </font>
  index := -1;
  i := 1;
  <font color="blue">while </font>index == -1<font color="blue"> and </font>i &lt;= len<font color="blue"> loop</font>
    <font color="blue">if </font>names[i] == name_to_find<font color="blue"> then</font>
      index := i;
    <font color="blue">end if</font>;
    i := i + 1;
  <font color="blue">end while</font>;
  <font color="red">assert</font>(index &lt;&gt; -1, &quot;FindName: failed&quot;);
<font color="blue">end </font>FindName;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Piecewise<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5.Piecewise"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.Piecewise</H2>
<B>A piecewise linear interpolation</B><p>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> Piecewise <font color="darkgreen">&quot;A piecewise linear interpolation&quot;</font>
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;Independent variable&quot;</font>;
  <font color="blue">input </font>Real x_grid[:] <font color="darkgreen">&quot;Independent variable data points&quot;</font>;
  <font color="blue">input </font>Real y_grid[:] <font color="darkgreen">&quot;Dependent variable data points&quot;</font>;
  <font color="blue">output </font>Real y <font color="darkgreen">&quot;Interpolated result&quot;</font>;
<font color="blue">protected </font>
  Integer n;
<font color="blue">algorithm </font>
  n := <font color="red">size</font>(x_grid, 1);
  <font color="red">assert</font>(<font color="red">size</font>(x_grid, 1) == <font color="red">size</font>(y_grid, 1), &quot;Size mismatch&quot;);
  <font color="red">assert</font>(x &gt;= x_grid[1]<font color="blue"> and </font>x &lt;= x_grid[n], &quot;Out of range&quot;);
  <font color="blue">for </font>i<font color="blue"> in </font>1:n - 1<font color="blue"> loop</font>
    <font color="blue">if </font>x &gt;= x_grid[i]<font color="blue"> and </font>x &lt;= x_grid[i + 1]<font color="blue"> then</font>
      y := y_grid[i] + (y_grid[i + 1] - y_grid[i])*((x - x_grid[i])/(x_grid[i
         + 1] - x_grid[i]));
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;
<font color="blue">end </font>Piecewise;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PolyEval<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5.PolyEval"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.PolyEval</H2>
<B>Evaluate polynomial and derivative</B><p>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> PolyEval <font color="darkgreen">&quot;Evaluate polynomial and derivative&quot;</font>
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;Independent variable&quot;</font>;
  <font color="blue">input </font>Real coef[:] <font color="darkgreen">&quot;Coefficients (low to high order)&quot;</font>;
  <font color="blue">output </font>Real y <font color="darkgreen">&quot;Result of polynomial evaluation&quot;</font>;
  <font color="blue">output </font>Real dydx <font color="darkgreen">&quot;Derivative of polynomial&quot;</font>;
<font color="blue">protected </font>
  Integer n;
<font color="blue">algorithm </font>
  n := <font color="red">size</font>(coef, 1);
  y := coef[n];
  dydx := 0.0;
  <font color="blue">for </font>i<font color="blue"> in </font>n - 1:-1:1<font color="blue"> loop</font>
    y := y*x + coef[i];
    dydx := dydx*x + i*coef[i + 1];
  <font color="blue">end for</font>;
<font color="blue">end </font>PolyEval;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TestComplexWave<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="BookExamples.Chapter5.TestComplexWaveI.png" ALT="BookExamples.Chapter5.TestComplexWave" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="BookExamples.Chapter5.TestComplexWave"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.TestComplexWave</H2>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>wdata</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TestComplexWave
  <font color="blue">extends </font><A HREF="BookExamples_Icons.html#BookExamples.Icons.RunnableExample"
>BookExamples.Icons.RunnableExample</A>;
  <font color="blue">parameter </font><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.ComplexWave.Data"
>ComplexWave.Data</A> wdata(
    num=3,
    a={1.3,2.2,5.8},
    f={2.0,3.0,7.0},
    phase={0,Modelica.Constants.pi,0});
  Real signal;
  <font color="blue">constant </font>Real pi=Modelica.Constants.pi;
  Real ver;
<font color="blue">equation </font>
  signal = <font color="red">ComplexWave</font>(time, wdata);
  ver = 1.3*<font color="red">Modelica.Math.sin</font>(pi*2.0*time) + 2.2*<font color="red">Modelica.Math.sin</font>(pi*3.0*time
     + pi) + 5.8*<font color="red">Modelica.Math.sin</font>(pi*7.0*time);
<font color="blue">end </font>TestComplexWave;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TestComplexWave2<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="BookExamples.Chapter5.TestComplexWave2I.png" ALT="BookExamples.Chapter5.TestComplexWave2" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="BookExamples.Chapter5.TestComplexWave2"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.TestComplexWave2</H2>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TestComplexWave2
  <font color="blue">extends </font><A HREF="BookExamples_Icons.html#BookExamples.Icons.RunnableExample"
>BookExamples.Icons.RunnableExample</A>;
  <A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.ComplexWave.Data"
>ComplexWave.Data</A> wdata(num=3);
  Real signal;
  <font color="blue">constant </font>Real pi=Modelica.Constants.pi;
  Real A;
  Real B;
<font color="blue">equation </font>
  wdata.a = {1.3,2.2,5.8*<font color="red">Modelica.Math.exp</font>(-.54*time)};
  wdata.f = {2.0,3.0,7.0};
  wdata.phase = {0,Modelica.Constants.pi,0};
  signal = <font color="red">ComplexWave</font>(time, wdata);
  A = 1.3*<font color="red">Modelica.Math.sin</font>(2.0*pi*2.0*time) + 2.2*<font color="red">Modelica.Math.sin</font>(2.0*pi*3.0
    *time + pi) + 5.8*<font color="red">Modelica.Math.sin</font>(2.0*pi*7.0*time);
  B = 1.3*<font color="red">Modelica.Math.sin</font>(2.0*pi*2.0*time) + 2.2*<font color="red">Modelica.Math.sin</font>(2.0*pi*3.0
    *time + pi);
<font color="blue">end </font>TestComplexWave2;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TestFindName<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="BookExamples.Chapter5.TestFindNameI.png" ALT="BookExamples.Chapter5.TestFindName" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="BookExamples.Chapter5.TestFindName"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.TestFindName</H2>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>names[:]</TD><TD>{&quot;H2O&quot;,&quot;CO2&quot;,&quot;N2&quot;}</TD><TD>&nbsp;</TD></TR>
<TR><TD>CO2</TD><TD>FindName(names, &quot;CO2&quot;)</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TestFindName
  <font color="blue">extends </font><A HREF="BookExamples_Icons.html#BookExamples.Icons.RunnableExample"
>BookExamples.Icons.RunnableExample</A>;
  <font color="blue">parameter </font>String names[:]={&quot;H2O&quot;,&quot;CO2&quot;,&quot;N2&quot;};
  <font color="blue">parameter </font>Integer CO2=<font color="red">FindName</font>(names, &quot;CO2&quot;);
<font color="blue">end </font>TestFindName;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TestPiecewise<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="BookExamples.Chapter5.TestPiecewiseI.png" ALT="BookExamples.Chapter5.TestPiecewise" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="BookExamples.Chapter5.TestPiecewise"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.TestPiecewise</H2>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>x_values[:]</TD><TD>{0,2,4,6,8,10}</TD><TD>[s]</TD></TR>
<TR><TD>y_values[:]</TD><TD>{0,0,4,16,36,64}</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TestPiecewise
  <font color="blue">extends </font><A HREF="BookExamples_Icons.html#BookExamples.Icons.RunnableExample"
>BookExamples.Icons.RunnableExample</A>;
  <font color="blue">import </font><A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits"
>Modelica.SIunits</A>;
  <font color="blue">parameter </font><A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>SIunits.Time</A> x_values[:]={0,2,4,6,8,10};
  <font color="blue">parameter </font>Real y_values[:]={0,0,4,16,36,64};
  Real y;
  Real x;
  Real z;
<font color="blue">equation </font>
  y = <font color="red">Piecewise</font>(x=time, x_grid=x_values, y_grid=y_values);
  <font color="red">der</font>(x) = -y;
  <font color="red">der</font>(z) = -x;
<font color="blue">end </font>TestPiecewise;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TestPolyEval<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="BookExamples.Chapter5.TestPolyEvalI.png" ALT="BookExamples.Chapter5.TestPolyEval" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="BookExamples.Chapter5.TestPolyEval"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5"
>BookExamples.Chapter5</A>.TestPolyEval</H2>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>coefs[3]</TD><TD>{2.0,1.0,2.0}</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TestPolyEval
  <font color="blue">extends </font><A HREF="BookExamples_Icons.html#BookExamples.Icons.RunnableExample"
>BookExamples.Icons.RunnableExample</A>;
  <font color="blue">parameter </font>Real coefs[3]={2.0,1.0,2.0};
  Real y;
  Real fdy;
  Real y2(start=<font color="red">PolyEval</font>(0, coefs));
<font color="blue">equation </font>
  (y,fdy) = <font color="red">PolyEval</font>(time, coefs);
  <font color="red">der</font>(y2) = fdy;
<font color="blue">end </font>TestPolyEval;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Data<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="BookExamples.Chapter5.ComplexWave.Data"></A><A HREF="BookExamples_Chapter5.html#BookExamples.Chapter5.ComplexWave"
>BookExamples.Chapter5.ComplexWave</A>.Data</H2>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>num</TD><TD>&nbsp;</TD><TD>Number of waves</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">encapsulated </font><font color="blue">record</font> Data
  <font color="blue">import </font><A HREF="../../Modelica/help/Modelica.html#Modelica"
>Modelica</A>;
  <font color="blue">constant </font>Integer num <font color="darkgreen">&quot;Number of waves&quot;</font>;
  Real a[num] <font color="darkgreen">&quot;Wave amplitudes&quot;</font>;
  <A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits.Frequency"
>Modelica.SIunits.Frequency</A> f[num] <font color="darkgreen">&quot;Wave frequencies&quot;</font>;
  <A HREF="../../Modelica/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> phase[num] <font color="darkgreen">&quot;Wave phase offset&quot;</font>;
<font color="blue">end </font>Data;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Mon Sep 15 14:02:04 2003
.
</address></BODY>
</HTML>
